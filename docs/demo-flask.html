<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Code X-Ray</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.9.0/d3.min.js"></script>
<style>
  /* ── Reset & Base ──────────────────────────────────────────────── */
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg:        #0d1117;
    --bg2:       #161b22;
    --bg3:       #21262d;
    --border:    #30363d;
    --text:      #c9d1d9;
    --text-muted:#8b949e;
    --accent:    #58a6ff;
    --accent2:   #3fb950;
    --danger:    #f85149;
    --warn:      #e3b341;
    --radius:    6px;
    --font:      -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    --mono:      ui-monospace, SFMono-Regular, "SF Mono", Consolas, "Liberation Mono", Menlo, monospace;
  }

  html, body {
    height: 100%;
    background: var(--bg);
    color: var(--text);
    font-family: var(--font);
    font-size: 14px;
    line-height: 1.5;
    overflow: hidden;
  }

  /* ── Layout ────────────────────────────────────────────────────── */
  #app {
    display: flex;
    flex-direction: column;
    height: 100vh;
    overflow: hidden;
  }

  /* ── Header ────────────────────────────────────────────────────── */
  #header {
    background: var(--bg2);
    border-bottom: 1px solid var(--border);
    padding: 0 20px;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  #header-top {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 0 8px;
    flex-wrap: wrap;
    gap: 10px;
  }

  #logo {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  #logo-icon {
    width: 32px;
    height: 32px;
    opacity: 0.9;
  }

  #logo-title {
    font-size: 20px;
    font-weight: 700;
    color: var(--text);
    letter-spacing: -0.3px;
  }

  #logo-title span {
    color: var(--accent);
  }

  #global-search {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  #global-search input {
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    color: var(--text);
    font-size: 13px;
    padding: 6px 10px 6px 30px;
    width: 240px;
    outline: none;
    transition: border-color 0.15s, box-shadow 0.15s;
    font-family: var(--font);
  }

  #global-search input:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(88,166,255,0.12);
  }

  #search-wrap {
    position: relative;
  }

  #search-wrap .search-icon {
    position: absolute;
    left: 8px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-muted);
    pointer-events: none;
    font-size: 13px;
  }

  #stats-bar {
    font-size: 12px;
    color: var(--text-muted);
    padding: 5px 0 10px;
    display: flex;
    gap: 18px;
    flex-wrap: wrap;
  }

  .stat-item {
    display: flex;
    align-items: center;
    gap: 5px;
  }

  .stat-item .stat-value {
    color: var(--text);
    font-weight: 600;
    font-variant-numeric: tabular-nums;
  }

  /* ── Tab Bar ───────────────────────────────────────────────────── */
  #tab-bar {
    display: flex;
    border-bottom: 1px solid var(--border);
    background: var(--bg2);
    padding: 0 20px;
    flex-shrink: 0;
  }

  .tab {
    padding: 10px 16px;
    cursor: pointer;
    color: var(--text-muted);
    font-size: 13px;
    font-weight: 500;
    border-bottom: 2px solid transparent;
    margin-bottom: -1px;
    transition: color 0.15s, border-color 0.15s;
    white-space: nowrap;
    user-select: none;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .tab:hover { color: var(--text); }

  .tab.active {
    color: var(--text);
    border-bottom-color: var(--accent);
  }

  /* ── Main Content ──────────────────────────────────────────────── */
  #views {
    flex: 1;
    overflow: hidden;
    position: relative;
  }

  .view {
    display: none;
    width: 100%;
    height: 100%;
    position: absolute;
    inset: 0;
    overflow: auto;
    scrollbar-width: thin;
    scrollbar-color: var(--border) transparent;
  }

  .view.active {
    display: flex;
    flex-direction: column;
  }

  /* ── Tooltip ───────────────────────────────────────────────────── */
  #tooltip {
    position: fixed;
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 10px 13px;
    font-size: 12px;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.12s;
    z-index: 9999;
    max-width: 300px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.5);
    line-height: 1.7;
  }

  #tooltip.visible { opacity: 1; }

  .tt-title {
    font-weight: 700;
    color: var(--text);
    margin-bottom: 4px;
    font-family: var(--mono);
    font-size: 11px;
    word-break: break-all;
  }

  .tt-row {
    display: flex;
    justify-content: space-between;
    gap: 16px;
  }

  .tt-label { color: var(--text-muted); }
  .tt-val { color: var(--text); font-weight: 500; }

  /* ── SVG common ────────────────────────────────────────────────── */
  svg text { font-family: var(--font); fill: var(--text); }

  /* ── View 1: Treemap ───────────────────────────────────────────── */
  #view-treemap {
    position: relative;
    padding: 12px;
  }

  #treemap-breadcrumb {
    font-size: 12px;
    color: var(--text-muted);
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 4px;
    flex-wrap: wrap;
    padding: 0 4px;
    flex-shrink: 0;
  }

  .bc-item {
    cursor: pointer;
    color: var(--accent);
    transition: opacity 0.15s;
  }

  .bc-item:hover { opacity: 0.8; }
  .bc-sep { color: var(--border); }

  #treemap-svg-wrap {
    flex: 1;
    min-height: 0;
    position: relative;
  }

  #treemap-svg-wrap svg {
    width: 100%;
    height: 100%;
  }

  .treemap-cell rect {
    stroke: var(--bg);
    stroke-width: 1.5;
    rx: 2;
    cursor: pointer;
    transition: opacity 0.15s;
  }

  .treemap-cell:hover rect { opacity: 0.85; stroke: var(--accent); stroke-width: 2; }

  .treemap-cell text {
    font-size: 11px;
    pointer-events: none;
    fill: rgba(255,255,255,0.88);
    font-weight: 500;
  }

  /* ── View 2: Force Graph ───────────────────────────────────────── */
  #view-force {
    position: relative;
  }

  #force-svg-wrap {
    flex: 1;
    min-height: 0;
    overflow: hidden;
  }

  #force-svg-wrap svg {
    width: 100%;
    height: 100%;
    cursor: grab;
  }

  #force-svg-wrap svg:active { cursor: grabbing; }

  .force-node circle {
    cursor: pointer;
    transition: opacity 0.15s;
  }

  .force-node text {
    font-size: 10px;
    pointer-events: none;
    fill: var(--text-muted);
  }

  .force-link {
    stroke: var(--border);
    stroke-opacity: 0.6;
    stroke-width: 1;
    marker-end: url(#arrowhead);
    fill: none;
  }

  .force-node.dimmed circle { opacity: 0.15; }
  .force-node.dimmed text { opacity: 0.1; }
  .force-link.dimmed { stroke-opacity: 0.07; }
  .force-node.highlighted circle { stroke-width: 2.5; }
  .force-link.highlighted { stroke: var(--accent); stroke-opacity: 0.9; stroke-width: 1.5; }

  #force-legend {
    position: absolute;
    top: 12px;
    right: 12px;
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 10px 13px;
    font-size: 11px;
    max-height: 300px;
    overflow-y: auto;
    scrollbar-width: thin;
  }

  #force-legend .leg-title {
    font-weight: 700;
    margin-bottom: 6px;
    color: var(--text-muted);
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .leg-item {
    display: flex;
    align-items: center;
    gap: 7px;
    margin-bottom: 4px;
    color: var(--text);
  }

  .leg-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    flex-shrink: 0;
  }

  /* ── View 3: Heatmap ───────────────────────────────────────────── */
  #view-heatmap {
    padding: 12px;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: var(--border) transparent;
  }

  #heatmap-legend {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 12px;
    font-size: 12px;
    flex-shrink: 0;
  }

  #heatmap-legend-label { color: var(--text-muted); }

  #heatmap-gradient {
    width: 160px;
    height: 12px;
    border-radius: 3px;
    border: 1px solid var(--border);
  }

  .hm-low { color: var(--text-muted); }
  .hm-high { color: var(--warn); }

  #heatmap-container {
    flex: 1;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: var(--border) transparent;
  }

  .hm-dir-group { margin-bottom: 20px; }

  .hm-dir-label {
    font-size: 11px;
    font-weight: 700;
    color: var(--text-muted);
    font-family: var(--mono);
    margin-bottom: 6px;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    padding-left: 2px;
  }

  .hm-cells {
    display: flex;
    flex-wrap: wrap;
    gap: 3px;
  }

  .hm-cell {
    width: 26px;
    height: 26px;
    border-radius: 3px;
    cursor: pointer;
    transition: transform 0.1s, box-shadow 0.1s;
    border: 1px solid transparent;
  }

  .hm-cell:hover {
    transform: scale(1.25);
    box-shadow: 0 0 0 2px var(--accent);
    border-color: var(--accent);
    z-index: 10;
    position: relative;
  }

  /* ── View 4: Table ─────────────────────────────────────────────── */
  #view-table {
    padding: 12px;
    gap: 10px;
    overflow: hidden;
  }

  #table-controls {
    display: flex;
    align-items: center;
    gap: 10px;
    flex-wrap: wrap;
    flex-shrink: 0;
  }

  #table-search-wrap {
    position: relative;
    flex: 1;
    min-width: 200px;
    max-width: 360px;
  }

  #table-search-wrap .search-icon {
    position: absolute;
    left: 8px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-muted);
    pointer-events: none;
    font-size: 13px;
  }

  #table-search {
    width: 100%;
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    color: var(--text);
    font-size: 13px;
    padding: 7px 10px 7px 30px;
    outline: none;
    font-family: var(--font);
    transition: border-color 0.15s;
  }

  #table-search:focus { border-color: var(--accent); }

  #table-row-count {
    font-size: 12px;
    color: var(--text-muted);
    white-space: nowrap;
  }

  #table-show-all {
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    color: var(--accent);
    font-size: 12px;
    padding: 5px 12px;
    cursor: pointer;
    transition: background 0.15s;
    font-family: var(--font);
    white-space: nowrap;
  }

  #table-show-all:hover { background: var(--bg2); }
  #table-show-all.hidden { display: none; }

  #table-wrap {
    flex: 1;
    overflow: auto;
    scrollbar-width: thin;
    scrollbar-color: var(--border) transparent;
    border: 1px solid var(--border);
    border-radius: var(--radius);
  }

  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
  }

  thead {
    position: sticky;
    top: 0;
    background: var(--bg3);
    z-index: 10;
  }

  th {
    padding: 9px 12px;
    text-align: left;
    color: var(--text-muted);
    font-weight: 600;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    cursor: pointer;
    user-select: none;
    border-bottom: 1px solid var(--border);
    white-space: nowrap;
    transition: color 0.15s;
  }

  th:hover { color: var(--text); }

  th.sort-asc::after  { content: " ↑"; color: var(--accent); }
  th.sort-desc::after { content: " ↓"; color: var(--accent); }

  td {
    padding: 8px 12px;
    border-bottom: 1px solid var(--border);
    font-family: var(--mono);
    font-size: 12px;
    max-width: 280px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    color: var(--text);
  }

  td:first-child { color: var(--accent); }

  tr:last-child td { border-bottom: none; }

  tbody tr:hover td { background: var(--bg3); }

  .lang-badge {
    display: inline-block;
    padding: 1px 7px;
    border-radius: 10px;
    font-size: 10px;
    font-weight: 600;
    font-family: var(--font);
    letter-spacing: 0.02em;
  }

  .num-cell { text-align: right; font-variant-numeric: tabular-nums; }

  /* ── Empty State ───────────────────────────────────────────────── */
  .empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    color: var(--text-muted);
    gap: 10px;
    font-size: 14px;
  }

  .empty-icon { font-size: 40px; opacity: 0.4; }

  /* ── Scrollbars ────────────────────────────────────────────────── */
  ::-webkit-scrollbar { width: 6px; height: 6px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
  ::-webkit-scrollbar-thumb:hover { background: #484f58; }

  /* ── Transitions ───────────────────────────────────────────────── */
  .view { animation: fadeIn 0.18s ease; }
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
</style>
</head>
<body>
<div id="app">
  <!-- ── Header ── -->
  <div id="header">
    <div id="header-top">
      <div id="logo">
        <svg id="logo-icon" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect width="32" height="32" rx="7" fill="#161b22" stroke="#30363d"/>
          <path d="M16 6 L26 11 L26 21 L16 26 L6 21 L6 11 Z" stroke="#58a6ff" stroke-width="1.5" fill="none" opacity="0.4"/>
          <ellipse cx="16" cy="16" rx="5" ry="8" stroke="#58a6ff" stroke-width="1.5" fill="none" transform="rotate(-30,16,16)"/>
          <circle cx="16" cy="16" r="2.5" fill="#58a6ff"/>
          <path d="M8 10 L24 22 M24 10 L8 22" stroke="#3fb950" stroke-width="1" opacity="0.5"/>
        </svg>
        <div id="logo-title">Code <span>X-Ray</span></div>
      </div>
      <div id="global-search">
        <div id="search-wrap">
          <span class="search-icon">&#x2315;</span>
          <input type="text" id="global-filter" placeholder="Filter files…" autocomplete="off">
        </div>
      </div>
    </div>
    <div id="stats-bar">
      <div class="stat-item">
        <span class="stat-value" id="s-files">0</span>
        <span>files</span>
      </div>
      <div class="stat-item">
        <span class="stat-value" id="s-lines">0</span>
        <span>lines</span>
      </div>
      <div class="stat-item">
        <span class="stat-value" id="s-langs">0</span>
        <span>languages</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">Generated:</span>
        <span class="stat-value" id="s-time">—</span>
      </div>
    </div>
  </div>

  <!-- ── Tab Bar ── -->
  <div id="tab-bar">
    <div class="tab active" data-tab="treemap">
      <span>&#9710;</span> Structure
    </div>
    <div class="tab" data-tab="force">
      <span>&#9672;</span> Dependencies
    </div>
    <div class="tab" data-tab="heatmap">
      <span>&#9635;</span> Heatmap
    </div>
    <div class="tab" data-tab="table">
      <span>&#9776;</span> Table
    </div>
  </div>

  <!-- ── Views ── -->
  <div id="views">

    <!-- View 1: Treemap -->
    <div id="view-treemap" class="view active">
      <div id="treemap-breadcrumb"></div>
      <div id="treemap-svg-wrap"></div>
    </div>

    <!-- View 2: Force Graph -->
    <div id="view-force" class="view">
      <div id="force-svg-wrap"></div>
      <div id="force-legend">
        <div class="leg-title">Languages</div>
        <div id="force-legend-items"></div>
      </div>
    </div>

    <!-- View 3: Heatmap -->
    <div id="view-heatmap" class="view">
      <div id="heatmap-legend">
        <span id="heatmap-legend-label">Activity:</span>
        <span class="hm-low">Low</span>
        <canvas id="heatmap-gradient" width="160" height="12"></canvas>
        <span class="hm-high">High</span>
      </div>
      <div id="heatmap-container"></div>
    </div>

    <!-- View 4: Table -->
    <div id="view-table" class="view">
      <div id="table-controls">
        <div id="table-search-wrap">
          <span class="search-icon">&#x2315;</span>
          <input type="text" id="table-search" placeholder="Search files…" autocomplete="off">
        </div>
        <span id="table-row-count"></span>
        <button id="table-show-all" class="hidden">Show all</button>
      </div>
      <div id="table-wrap">
        <table id="data-table">
          <thead>
            <tr>
              <th data-col="id">File</th>
              <th data-col="language">Language</th>
              <th data-col="category">Category</th>
              <th data-col="lines" class="num-cell">Lines</th>
              <th data-col="size" class="num-cell">Size</th>
              <th data-col="deps" class="num-cell">Deps</th>
              <th data-col="git_commits" class="num-cell">Commits</th>
            </tr>
          </thead>
          <tbody id="table-body"></tbody>
        </table>
      </div>
    </div>

  </div><!-- /views -->
</div><!-- /app -->

<!-- ── Tooltip ── -->
<div id="tooltip"></div>

<!-- ── Data Injection Point ── -->
<script>
const XRAY_DATA = /*__XRAY_DATA__*/{"meta":{"project":"flask-demo","scan_time":"2026-02-25T02:08:14+00:00","version":"1.0.0"},"summary":{"total_files":235,"total_lines":36323,"languages":{"python":83,"html":20,"sql":2,"css":2,"shell":1},"categories":{"doc":89,"test":69,"source":55,"config":13,"asset":8,"script":1}},"nodes":[{"id":".editorconfig","language":"unknown","category":"source","lines":13,"size":246,"directory":"","git_commits":0,"git_last_modified":""},{"id":".gitignore","language":"unknown","category":"source","lines":8,"size":82,"directory":"","git_commits":0,"git_last_modified":""},{"id":".pre-commit-config.yaml","language":"unknown","category":"config","lines":23,"size":849,"directory":"","git_commits":0,"git_last_modified":""},{"id":".readthedocs.yaml","language":"unknown","category":"config","lines":10,"size":252,"directory":"","git_commits":0,"git_last_modified":""},{"id":"CHANGES.rst","language":"unknown","category":"doc","lines":1663,"size":75040,"directory":"","git_commits":0,"git_last_modified":""},{"id":"LICENSE.txt","language":"unknown","category":"doc","lines":28,"size":1503,"directory":"","git_commits":0,"git_last_modified":""},{"id":"pyproject.toml","language":"unknown","category":"config","lines":278,"size":6835,"directory":"","git_commits":0,"git_last_modified":""},{"id":"README.md","language":"unknown","category":"doc","lines":53,"size":1692,"directory":"","git_commits":0,"git_last_modified":""},{"id":"uv.lock","language":"unknown","category":"config","lines":1749,"size":297667,"directory":"","git_commits":0,"git_last_modified":""},{"id":".devcontainer/devcontainer.json","language":"unknown","category":"config","lines":17,"size":451,"directory":".devcontainer","git_commits":0,"git_last_modified":""},{"id":".devcontainer/on-create-command.sh","language":"shell","category":"script","lines":7,"size":172,"directory":".devcontainer","git_commits":0,"git_last_modified":""},{"id":".github/pull_request_template.md","language":"unknown","category":"doc","lines":25,"size":847,"directory":".github","git_commits":0,"git_last_modified":""},{"id":".github/ISSUE_TEMPLATE/bug-report.md","language":"unknown","category":"doc","lines":27,"size":642,"directory":".github/ISSUE_TEMPLATE","git_commits":0,"git_last_modified":""},{"id":".github/ISSUE_TEMPLATE/config.yml","language":"unknown","category":"config","lines":11,"size":522,"directory":".github/ISSUE_TEMPLATE","git_commits":0,"git_last_modified":""},{"id":".github/ISSUE_TEMPLATE/feature-request.md","language":"unknown","category":"doc","lines":15,"size":431,"directory":".github/ISSUE_TEMPLATE","git_commits":0,"git_last_modified":""},{"id":".github/workflows/lock.yaml","language":"unknown","category":"config","lines":24,"size":706,"directory":".github/workflows","git_commits":0,"git_last_modified":""},{"id":".github/workflows/pre-commit.yaml","language":"unknown","category":"config","lines":25,"size":1008,"directory":".github/workflows","git_commits":0,"git_last_modified":""},{"id":".github/workflows/publish.yaml","language":"unknown","category":"config","lines":58,"size":2004,"directory":".github/workflows","git_commits":0,"git_last_modified":""},{"id":".github/workflows/tests.yaml","language":"unknown","category":"config","lines":53,"size":2049,"directory":".github/workflows","git_commits":0,"git_last_modified":""},{"id":"docs/api.rst","language":"unknown","category":"doc","lines":708,"size":21920,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/appcontext.rst","language":"unknown","category":"doc","lines":187,"size":7878,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/async-await.rst","language":"unknown","category":"doc","lines":119,"size":4828,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/blueprints.rst","language":"unknown","category":"doc","lines":315,"size":12874,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/changes.rst","language":"unknown","category":"doc","lines":4,"size":49,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/cli.rst","language":"unknown","category":"doc","lines":556,"size":17257,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/conf.py","language":"python","category":"source","lines":101,"size":3487,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/config.rst","language":"unknown","category":"doc","lines":839,"size":29849,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/contributing.rst","language":"unknown","category":"doc","lines":8,"size":282,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/debugging.rst","language":"unknown","category":"doc","lines":99,"size":3561,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/design.rst","language":"unknown","category":"doc","lines":229,"size":11444,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/errorhandling.rst","language":"unknown","category":"doc","lines":523,"size":18896,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/extensiondev.rst","language":"unknown","category":"doc","lines":305,"size":13223,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/extensions.rst","language":"unknown","category":"doc","lines":48,"size":1420,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/gevent.rst","language":"unknown","category":"doc","lines":125,"size":4200,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/index.rst","language":"unknown","category":"doc","lines":89,"size":2154,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/installation.rst","language":"unknown","category":"doc","lines":143,"size":3911,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/license.rst","language":"unknown","category":"doc","lines":5,"size":103,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/lifecycle.rst","language":"unknown","category":"doc","lines":171,"size":9158,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/logging.rst","language":"unknown","category":"doc","lines":183,"size":6110,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/make.bat","language":"unknown","category":"source","lines":35,"size":795,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/Makefile","language":"unknown","category":"source","lines":20,"size":654,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/quickstart.rst","language":"unknown","category":"doc","lines":858,"size":30913,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/reqcontext.rst","language":"unknown","category":"doc","lines":6,"size":99,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/server.rst","language":"unknown","category":"doc","lines":115,"size":3827,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/shell.rst","language":"unknown","category":"doc","lines":81,"size":2934,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/signals.rst","language":"unknown","category":"doc","lines":166,"size":6273,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/templating.rst","language":"unknown","category":"doc","lines":255,"size":8866,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/testing.rst","language":"unknown","category":"doc","lines":318,"size":10744,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/views.rst","language":"unknown","category":"doc","lines":324,"size":10594,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/web-security.rst","language":"unknown","category":"doc","lines":316,"size":13401,"directory":"docs","git_commits":0,"git_last_modified":""},{"id":"docs/deploying/apache-httpd.rst","language":"unknown","category":"doc","lines":66,"size":2430,"directory":"docs/deploying","git_commits":0,"git_last_modified":""},{"id":"docs/deploying/asgi.rst","language":"unknown","category":"doc","lines":27,"size":700,"directory":"docs/deploying","git_commits":0,"git_last_modified":""},{"id":"docs/deploying/eventlet.rst","language":"unknown","category":"doc","lines":8,"size":149,"directory":"docs/deploying","git_commits":0,"git_last_modified":""},{"id":"docs/deploying/gevent.rst","language":"unknown","category":"doc","lines":76,"size":2324,"directory":"docs/deploying","git_commits":0,"git_last_modified":""},{"id":"docs/deploying/gunicorn.rst","language":"unknown","category":"doc","lines":116,"size":3761,"directory":"docs/deploying","git_commits":0,"git_last_modified":""},{"id":"docs/deploying/index.rst","language":"unknown","category":"doc","lines":78,"size":3251,"directory":"docs/deploying","git_commits":0,"git_last_modified":""},{"id":"docs/deploying/mod_wsgi.rst","language":"unknown","category":"doc","lines":94,"size":2907,"directory":"docs/deploying","git_commits":0,"git_last_modified":""},{"id":"docs/deploying/nginx.rst","language":"unknown","category":"doc","lines":69,"size":2385,"directory":"docs/deploying","git_commits":0,"git_last_modified":""},{"id":"docs/deploying/proxy_fix.rst","language":"unknown","category":"doc","lines":33,"size":1398,"directory":"docs/deploying","git_commits":0,"git_last_modified":""},{"id":"docs/deploying/uwsgi.rst","language":"unknown","category":"doc","lines":143,"size":4877,"directory":"docs/deploying","git_commits":0,"git_last_modified":""},{"id":"docs/deploying/waitress.rst","language":"unknown","category":"doc","lines":75,"size":2412,"directory":"docs/deploying","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/appdispatch.rst","language":"unknown","category":"doc","lines":189,"size":6696,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/appfactories.rst","language":"unknown","category":"doc","lines":118,"size":4216,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/caching.rst","language":"unknown","category":"doc","lines":16,"size":669,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/celery.rst","language":"unknown","category":"doc","lines":242,"size":8912,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/deferredcallbacks.rst","language":"unknown","category":"doc","lines":44,"size":1892,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/favicon.rst","language":"unknown","category":"doc","lines":56,"size":2157,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/fileuploads.rst","language":"unknown","category":"doc","lines":182,"size":7479,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/flashing.rst","language":"unknown","category":"doc","lines":148,"size":4684,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/index.rst","language":"unknown","category":"doc","lines":40,"size":1001,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/javascript.rst","language":"unknown","category":"doc","lines":261,"size":9299,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/jquery.rst","language":"unknown","category":"doc","lines":6,"size":102,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/lazyloading.rst","language":"unknown","category":"doc","lines":109,"size":3956,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/methodoverrides.rst","language":"unknown","category":"doc","lines":42,"size":1498,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/mongoengine.rst","language":"unknown","category":"doc","lines":103,"size":2960,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/packages.rst","language":"unknown","category":"doc","lines":133,"size":4238,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/requestchecksum.rst","language":"unknown","category":"doc","lines":55,"size":1916,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/singlepageapplications.rst","language":"unknown","category":"doc","lines":24,"size":755,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/sqlalchemy.rst","language":"unknown","category":"doc","lines":213,"size":7478,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/sqlite3.rst","language":"unknown","category":"doc","lines":147,"size":5175,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/streaming.rst","language":"unknown","category":"doc","lines":85,"size":2739,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/subclassing.rst","language":"unknown","category":"doc","lines":17,"size":693,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/templateinheritance.rst","language":"unknown","category":"doc","lines":68,"size":2265,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/urlprocessors.rst","language":"unknown","category":"doc","lines":126,"size":4432,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/viewdecorators.rst","language":"unknown","category":"doc","lines":171,"size":6489,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/patterns/wtforms.rst","language":"unknown","category":"doc","lines":126,"size":4834,"directory":"docs/patterns","git_commits":0,"git_last_modified":""},{"id":"docs/tutorial/blog.rst","language":"unknown","category":"doc","lines":336,"size":11724,"directory":"docs/tutorial","git_commits":0,"git_last_modified":""},{"id":"docs/tutorial/database.rst","language":"unknown","category":"doc","lines":219,"size":7247,"directory":"docs/tutorial","git_commits":0,"git_last_modified":""},{"id":"docs/tutorial/deploy.rst","language":"unknown","category":"doc","lines":111,"size":3810,"directory":"docs/tutorial","git_commits":0,"git_last_modified":""},{"id":"docs/tutorial/factory.rst","language":"unknown","category":"doc","lines":159,"size":6037,"directory":"docs/tutorial","git_commits":0,"git_last_modified":""},{"id":"docs/tutorial/flaskr_edit.png","language":"unknown","category":"asset","lines":0,"size":13259,"directory":"docs/tutorial","git_commits":0,"git_last_modified":""},{"id":"docs/tutorial/flaskr_index.png","language":"unknown","category":"asset","lines":0,"size":11675,"directory":"docs/tutorial","git_commits":0,"git_last_modified":""},{"id":"docs/tutorial/flaskr_login.png","language":"unknown","category":"asset","lines":0,"size":7455,"directory":"docs/tutorial","git_commits":0,"git_last_modified":""},{"id":"docs/tutorial/index.rst","language":"unknown","category":"doc","lines":64,"size":2125,"directory":"docs/tutorial","git_commits":0,"git_last_modified":""},{"id":"docs/tutorial/install.rst","language":"unknown","category":"doc","lines":89,"size":2927,"directory":"docs/tutorial","git_commits":0,"git_last_modified":""},{"id":"docs/tutorial/layout.rst","language":"unknown","category":"doc","lines":110,"size":3052,"directory":"docs/tutorial","git_commits":0,"git_last_modified":""},{"id":"docs/tutorial/next.rst","language":"unknown","category":"doc","lines":38,"size":1669,"directory":"docs/tutorial","git_commits":0,"git_last_modified":""},{"id":"docs/tutorial/static.rst","language":"unknown","category":"doc","lines":72,"size":3242,"directory":"docs/tutorial","git_commits":0,"git_last_modified":""},{"id":"docs/tutorial/templates.rst","language":"unknown","category":"doc","lines":187,"size":7149,"directory":"docs/tutorial","git_commits":0,"git_last_modified":""},{"id":"docs/tutorial/tests.rst","language":"unknown","category":"doc","lines":559,"size":18827,"directory":"docs/tutorial","git_commits":0,"git_last_modified":""},{"id":"docs/tutorial/views.rst","language":"unknown","category":"doc","lines":305,"size":11229,"directory":"docs/tutorial","git_commits":0,"git_last_modified":""},{"id":"docs/_static/debugger.png","language":"unknown","category":"asset","lines":0,"size":207889,"directory":"docs/_static","git_commits":0,"git_last_modified":""},{"id":"docs/_static/flask-icon.svg","language":"unknown","category":"asset","lines":0,"size":2014,"directory":"docs/_static","git_commits":0,"git_last_modified":""},{"id":"docs/_static/flask-logo.svg","language":"unknown","category":"asset","lines":0,"size":3472,"directory":"docs/_static","git_commits":0,"git_last_modified":""},{"id":"docs/_static/flask-name.svg","language":"unknown","category":"asset","lines":0,"size":5334,"directory":"docs/_static","git_commits":0,"git_last_modified":""},{"id":"docs/_static/pycharm-run-config.png","language":"unknown","category":"asset","lines":0,"size":99654,"directory":"docs/_static","git_commits":0,"git_last_modified":""},{"id":"examples/celery/make_celery.py","language":"python","category":"source","lines":4,"size":106,"directory":"examples/celery","git_commits":0,"git_last_modified":""},{"id":"examples/celery/pyproject.toml","language":"unknown","category":"config","lines":17,"size":398,"directory":"examples/celery","git_commits":0,"git_last_modified":""},{"id":"examples/celery/README.md","language":"unknown","category":"doc","lines":27,"size":977,"directory":"examples/celery","git_commits":0,"git_last_modified":""},{"id":"examples/celery/requirements.txt","language":"unknown","category":"doc","lines":58,"size":1131,"directory":"examples/celery","git_commits":0,"git_last_modified":""},{"id":"examples/celery/src/task_app/tasks.py","language":"python","category":"source","lines":23,"size":507,"directory":"examples/celery/src/task_app","git_commits":0,"git_last_modified":""},{"id":"examples/celery/src/task_app/views.py","language":"python","category":"source","lines":38,"size":992,"directory":"examples/celery/src/task_app","git_commits":0,"git_last_modified":""},{"id":"examples/celery/src/task_app/__init__.py","language":"python","category":"source","lines":39,"size":1058,"directory":"examples/celery/src/task_app","git_commits":0,"git_last_modified":""},{"id":"examples/celery/src/task_app/templates/index.html","language":"html","category":"source","lines":108,"size":3017,"directory":"examples/celery/src/task_app/templates","git_commits":0,"git_last_modified":""},{"id":"examples/javascript/.gitignore","language":"unknown","category":"source","lines":14,"size":133,"directory":"examples/javascript","git_commits":0,"git_last_modified":""},{"id":"examples/javascript/LICENSE.txt","language":"unknown","category":"doc","lines":28,"size":1503,"directory":"examples/javascript","git_commits":0,"git_last_modified":""},{"id":"examples/javascript/pyproject.toml","language":"unknown","category":"config","lines":33,"size":769,"directory":"examples/javascript","git_commits":0,"git_last_modified":""},{"id":"examples/javascript/README.rst","language":"unknown","category":"doc","lines":48,"size":1134,"directory":"examples/javascript","git_commits":0,"git_last_modified":""},{"id":"examples/javascript/js_example/views.py","language":"python","category":"source","lines":18,"size":447,"directory":"examples/javascript/js_example","git_commits":0,"git_last_modified":""},{"id":"examples/javascript/js_example/__init__.py","language":"python","category":"source","lines":5,"size":102,"directory":"examples/javascript/js_example","git_commits":0,"git_last_modified":""},{"id":"examples/javascript/js_example/templates/base.html","language":"html","category":"source","lines":33,"size":1211,"directory":"examples/javascript/js_example/templates","git_commits":0,"git_last_modified":""},{"id":"examples/javascript/js_example/templates/fetch.html","language":"html","category":"source","lines":33,"size":885,"directory":"examples/javascript/js_example/templates","git_commits":0,"git_last_modified":""},{"id":"examples/javascript/js_example/templates/jquery.html","language":"html","category":"source","lines":27,"size":693,"directory":"examples/javascript/js_example/templates","git_commits":0,"git_last_modified":""},{"id":"examples/javascript/js_example/templates/xhr.html","language":"html","category":"source","lines":29,"size":962,"directory":"examples/javascript/js_example/templates","git_commits":0,"git_last_modified":""},{"id":"examples/javascript/tests/conftest.py","language":"python","category":"test","lines":15,"size":231,"directory":"examples/javascript/tests","git_commits":0,"git_last_modified":""},{"id":"examples/javascript/tests/test_js_example.py","language":"python","category":"test","lines":27,"size":754,"directory":"examples/javascript/tests","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/.gitignore","language":"unknown","category":"source","lines":14,"size":133,"directory":"examples/tutorial","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/LICENSE.txt","language":"unknown","category":"doc","lines":28,"size":1503,"directory":"examples/tutorial","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/pyproject.toml","language":"unknown","category":"config","lines":40,"size":811,"directory":"examples/tutorial","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/README.rst","language":"unknown","category":"doc","lines":68,"size":1341,"directory":"examples/tutorial","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/flaskr/auth.py","language":"python","category":"source","lines":116,"size":3412,"directory":"examples/tutorial/flaskr","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/flaskr/blog.py","language":"python","category":"source","lines":125,"size":3430,"directory":"examples/tutorial/flaskr","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/flaskr/db.py","language":"python","category":"source","lines":56,"size":1373,"directory":"examples/tutorial/flaskr","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/flaskr/schema.sql","language":"sql","category":"source","lines":20,"size":518,"directory":"examples/tutorial/flaskr","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/flaskr/__init__.py","language":"python","category":"source","lines":48,"size":1454,"directory":"examples/tutorial/flaskr","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/flaskr/static/style.css","language":"css","category":"source","lines":134,"size":1830,"directory":"examples/tutorial/flaskr/static","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/flaskr/templates/base.html","language":"html","category":"source","lines":24,"size":776,"directory":"examples/tutorial/flaskr/templates","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/flaskr/templates/auth/login.html","language":"html","category":"source","lines":15,"size":439,"directory":"examples/tutorial/flaskr/templates/auth","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/flaskr/templates/auth/register.html","language":"html","category":"source","lines":15,"size":443,"directory":"examples/tutorial/flaskr/templates/auth","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/flaskr/templates/blog/create.html","language":"html","category":"source","lines":15,"size":462,"directory":"examples/tutorial/flaskr/templates/blog","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/flaskr/templates/blog/index.html","language":"html","category":"source","lines":28,"size":818,"directory":"examples/tutorial/flaskr/templates/blog","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/flaskr/templates/blog/update.html","language":"html","category":"source","lines":19,"size":709,"directory":"examples/tutorial/flaskr/templates/blog","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/tests/conftest.py","language":"python","category":"test","lines":62,"size":1516,"directory":"examples/tutorial/tests","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/tests/data.sql","language":"sql","category":"test","lines":8,"size":402,"directory":"examples/tutorial/tests","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/tests/test_auth.py","language":"python","category":"test","lines":69,"size":2139,"directory":"examples/tutorial/tests","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/tests/test_blog.py","language":"python","category":"test","lines":83,"size":2586,"directory":"examples/tutorial/tests","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/tests/test_db.py","language":"python","category":"test","lines":29,"size":645,"directory":"examples/tutorial/tests","git_commits":0,"git_last_modified":""},{"id":"examples/tutorial/tests/test_factory.py","language":"python","category":"test","lines":12,"size":310,"directory":"examples/tutorial/tests","git_commits":0,"git_last_modified":""},{"id":"src/flask/app.py","language":"python","category":"source","lines":1625,"size":67048,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/blueprints.py","language":"python","category":"source","lines":128,"size":4669,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/cli.py","language":"python","category":"source","lines":1127,"size":37935,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/config.py","language":"python","category":"source","lines":367,"size":13586,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/ctx.py","language":"python","category":"source","lines":540,"size":18644,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/debughelpers.py","language":"python","category":"source","lines":179,"size":6249,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/globals.py","language":"python","category":"source","lines":77,"size":2491,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/helpers.py","language":"python","category":"source","lines":670,"size":24723,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/logging.py","language":"python","category":"source","lines":79,"size":2456,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/py.typed","language":"unknown","category":"source","lines":0,"size":0,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/sessions.py","language":"python","category":"source","lines":385,"size":15354,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/signals.py","language":"python","category":"source","lines":17,"size":767,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/templating.py","language":"python","category":"source","lines":212,"size":7548,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/testing.py","language":"python","category":"source","lines":298,"size":10412,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/typing.py","language":"python","category":"source","lines":87,"size":3201,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/views.py","language":"python","category":"source","lines":191,"size":7153,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/wrappers.py","language":"python","category":"source","lines":257,"size":9663,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/__init__.py","language":"python","category":"source","lines":39,"size":2111,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/__main__.py","language":"python","category":"source","lines":3,"size":33,"directory":"src/flask","git_commits":0,"git_last_modified":""},{"id":"src/flask/json/provider.py","language":"python","category":"source","lines":215,"size":7859,"directory":"src/flask/json","git_commits":0,"git_last_modified":""},{"id":"src/flask/json/tag.py","language":"python","category":"source","lines":327,"size":9608,"directory":"src/flask/json","git_commits":0,"git_last_modified":""},{"id":"src/flask/json/__init__.py","language":"python","category":"source","lines":170,"size":5753,"directory":"src/flask/json","git_commits":0,"git_last_modified":""},{"id":"src/flask/sansio/app.py","language":"python","category":"source","lines":1010,"size":40392,"directory":"src/flask/sansio","git_commits":0,"git_last_modified":""},{"id":"src/flask/sansio/blueprints.py","language":"python","category":"source","lines":692,"size":27709,"directory":"src/flask/sansio","git_commits":0,"git_last_modified":""},{"id":"src/flask/sansio/README.md","language":"unknown","category":"doc","lines":6,"size":234,"directory":"src/flask/sansio","git_commits":0,"git_last_modified":""},{"id":"src/flask/sansio/scaffold.py","language":"python","category":"source","lines":792,"size":31156,"directory":"src/flask/sansio","git_commits":0,"git_last_modified":""},{"id":"tests/conftest.py","language":"python","category":"test","lines":129,"size":3422,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_appctx.py","language":"python","category":"test","lines":265,"size":7092,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_async.py","language":"python","category":"test","lines":145,"size":3480,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_basic.py","language":"python","category":"test","lines":1970,"size":56091,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_blueprints.py","language":"python","category":"test","lines":1118,"size":32572,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_cli.py","language":"python","category":"test","lines":703,"size":21086,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_config.py","language":"python","category":"test","lines":250,"size":7998,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_converters.py","language":"python","category":"test","lines":42,"size":1135,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_helpers.py","language":"python","category":"test","lines":377,"size":11595,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_instance_config.py","language":"python","category":"test","lines":111,"size":3428,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_json.py","language":"python","category":"test","lines":346,"size":9087,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_json_tag.py","language":"python","category":"test","lines":86,"size":2084,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_logging.py","language":"python","category":"test","lines":98,"size":2627,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_regression.py","language":"python","category":"test","lines":30,"size":742,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_reqctx.py","language":"python","category":"test","lines":326,"size":9024,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_request.py","language":"python","category":"test","lines":70,"size":1972,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_session_interface.py","language":"python","category":"test","lines":28,"size":812,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_signals.py","language":"python","category":"test","lines":181,"size":5045,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_subclassing.py","language":"python","category":"test","lines":21,"size":501,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_templating.py","language":"python","category":"test","lines":532,"size":15935,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_testing.py","language":"python","category":"test","lines":384,"size":10603,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_user_error_handler.py","language":"python","category":"test","lines":295,"size":8731,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/test_views.py","language":"python","category":"test","lines":272,"size":7447,"directory":"tests","git_commits":0,"git_last_modified":""},{"id":"tests/static/config.json","language":"unknown","category":"test","lines":4,"size":58,"directory":"tests/static","git_commits":0,"git_last_modified":""},{"id":"tests/static/config.toml","language":"unknown","category":"test","lines":2,"size":37,"directory":"tests/static","git_commits":0,"git_last_modified":""},{"id":"tests/static/index.html","language":"html","category":"test","lines":1,"size":23,"directory":"tests/static","git_commits":0,"git_last_modified":""},{"id":"tests/templates/context_template.html","language":"html","category":"test","lines":1,"size":37,"directory":"tests/templates","git_commits":0,"git_last_modified":""},{"id":"tests/templates/escaping_template.html","language":"html","category":"test","lines":6,"size":153,"directory":"tests/templates","git_commits":0,"git_last_modified":""},{"id":"tests/templates/mail.txt","language":"unknown","category":"test","lines":1,"size":15,"directory":"tests/templates","git_commits":0,"git_last_modified":""},{"id":"tests/templates/non_escaping_template.txt","language":"unknown","category":"test","lines":8,"size":177,"directory":"tests/templates","git_commits":0,"git_last_modified":""},{"id":"tests/templates/simple_template.html","language":"html","category":"test","lines":1,"size":24,"directory":"tests/templates","git_commits":0,"git_last_modified":""},{"id":"tests/templates/template_filter.html","language":"html","category":"test","lines":1,"size":27,"directory":"tests/templates","git_commits":0,"git_last_modified":""},{"id":"tests/templates/template_test.html","language":"html","category":"test","lines":3,"size":54,"directory":"tests/templates","git_commits":0,"git_last_modified":""},{"id":"tests/templates/_macro.html","language":"html","category":"test","lines":1,"size":56,"directory":"tests/templates","git_commits":0,"git_last_modified":""},{"id":"tests/templates/nested/nested.txt","language":"unknown","category":"test","lines":1,"size":12,"directory":"tests/templates/nested","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/.env","language":"unknown","category":"test","lines":4,"size":37,"directory":"tests/test_apps","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/.flaskenv","language":"unknown","category":"test","lines":3,"size":31,"directory":"tests/test_apps","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/blueprintapp/__init__.py","language":"python","category":"test","lines":9,"size":265,"directory":"tests/test_apps/blueprintapp","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/blueprintapp/apps/__init__.py","language":"python","category":"test","lines":0,"size":0,"directory":"tests/test_apps/blueprintapp/apps","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/blueprintapp/apps/admin/__init__.py","language":"python","category":"test","lines":20,"size":386,"directory":"tests/test_apps/blueprintapp/apps/admin","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/blueprintapp/apps/admin/static/test.txt","language":"unknown","category":"test","lines":1,"size":12,"directory":"tests/test_apps/blueprintapp/apps/admin/static","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/blueprintapp/apps/admin/static/css/test.css","language":"css","category":"test","lines":1,"size":19,"directory":"tests/test_apps/blueprintapp/apps/admin/static/css","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/blueprintapp/apps/admin/templates/admin/index.html","language":"html","category":"test","lines":1,"size":22,"directory":"tests/test_apps/blueprintapp/apps/admin/templates/admin","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/blueprintapp/apps/frontend/__init__.py","language":"python","category":"test","lines":14,"size":341,"directory":"tests/test_apps/blueprintapp/apps/frontend","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/blueprintapp/apps/frontend/templates/frontend/index.html","language":"html","category":"test","lines":1,"size":25,"directory":"tests/test_apps/blueprintapp/apps/frontend/templates/frontend","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/cliapp/app.py","language":"python","category":"test","lines":3,"size":55,"directory":"tests/test_apps/cliapp","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/cliapp/factory.py","language":"python","category":"test","lines":13,"size":182,"directory":"tests/test_apps/cliapp","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/cliapp/importerrorapp.py","language":"python","category":"test","lines":5,"size":78,"directory":"tests/test_apps/cliapp","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/cliapp/message.txt","language":"unknown","category":"test","lines":1,"size":39,"directory":"tests/test_apps/cliapp","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/cliapp/multiapp.py","language":"python","category":"test","lines":4,"size":71,"directory":"tests/test_apps/cliapp","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/cliapp/__init__.py","language":"python","category":"test","lines":0,"size":0,"directory":"tests/test_apps/cliapp","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/cliapp/inner1/__init__.py","language":"python","category":"test","lines":3,"size":58,"directory":"tests/test_apps/cliapp/inner1","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/cliapp/inner1/inner2/flask.py","language":"python","category":"test","lines":3,"size":50,"directory":"tests/test_apps/cliapp/inner1/inner2","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/cliapp/inner1/inner2/__init__.py","language":"python","category":"test","lines":0,"size":0,"directory":"tests/test_apps/cliapp/inner1/inner2","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/helloworld/hello.py","language":"python","category":"test","lines":8,"size":112,"directory":"tests/test_apps/helloworld","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/helloworld/wsgi.py","language":"python","category":"test","lines":1,"size":37,"directory":"tests/test_apps/helloworld","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/subdomaintestmodule/__init__.py","language":"python","category":"test","lines":3,"size":76,"directory":"tests/test_apps/subdomaintestmodule","git_commits":0,"git_last_modified":""},{"id":"tests/test_apps/subdomaintestmodule/static/hello.txt","language":"unknown","category":"test","lines":1,"size":17,"directory":"tests/test_apps/subdomaintestmodule/static","git_commits":0,"git_last_modified":""},{"id":"tests/type_check/typing_app_decorators.py","language":"python","category":"test","lines":32,"size":621,"directory":"tests/type_check","git_commits":0,"git_last_modified":""},{"id":"tests/type_check/typing_error_handler.py","language":"python","category":"test","lines":33,"size":680,"directory":"tests/type_check","git_commits":0,"git_last_modified":""},{"id":"tests/type_check/typing_route.py","language":"python","category":"test","lines":112,"size":2644,"directory":"tests/type_check","git_commits":0,"git_last_modified":""}],"edges":[{"source":"examples/celery/src/task_app/__init__.py","target":"examples/celery/src/task_app/__init__.py","type":"import"},{"source":"examples/celery/src/task_app/views.py","target":"examples/celery/src/task_app/__init__.py","type":"import"},{"source":"examples/javascript/js_example/views.py","target":"examples/javascript/js_example/__init__.py","type":"import"},{"source":"examples/tutorial/flaskr/__init__.py","target":"examples/tutorial/flaskr/__init__.py","type":"import"},{"source":"examples/tutorial/flaskr/auth.py","target":"examples/tutorial/flaskr/db.py","type":"import"},{"source":"examples/tutorial/flaskr/blog.py","target":"examples/tutorial/flaskr/auth.py","type":"import"},{"source":"examples/tutorial/flaskr/blog.py","target":"examples/tutorial/flaskr/db.py","type":"import"},{"source":"src/flask/__init__.py","target":"src/flask/__init__.py","type":"import"},{"source":"src/flask/__init__.py","target":"src/flask/app.py","type":"import"},{"source":"src/flask/__init__.py","target":"src/flask/blueprints.py","type":"import"},{"source":"src/flask/__init__.py","target":"src/flask/config.py","type":"import"},{"source":"src/flask/__init__.py","target":"src/flask/ctx.py","type":"import"},{"source":"src/flask/__init__.py","target":"src/flask/globals.py","type":"import"},{"source":"src/flask/__init__.py","target":"src/flask/helpers.py","type":"import"},{"source":"src/flask/__init__.py","target":"src/flask/json/__init__.py","type":"import"},{"source":"src/flask/__init__.py","target":"src/flask/signals.py","type":"import"},{"source":"src/flask/__init__.py","target":"src/flask/templating.py","type":"import"},{"source":"src/flask/__init__.py","target":"src/flask/wrappers.py","type":"import"},{"source":"src/flask/__main__.py","target":"src/flask/cli.py","type":"import"},{"source":"src/flask/app.py","target":"src/flask/__init__.py","type":"import"},{"source":"src/flask/app.py","target":"src/flask/ctx.py","type":"import"},{"source":"src/flask/app.py","target":"src/flask/debughelpers.py","type":"import"},{"source":"src/flask/app.py","target":"src/flask/globals.py","type":"import"},{"source":"src/flask/app.py","target":"src/flask/helpers.py","type":"import"},{"source":"src/flask/app.py","target":"src/flask/sansio/app.py","type":"import"},{"source":"src/flask/app.py","target":"src/flask/sessions.py","type":"import"},{"source":"src/flask/app.py","target":"src/flask/signals.py","type":"import"},{"source":"src/flask/app.py","target":"src/flask/templating.py","type":"import"},{"source":"src/flask/app.py","target":"src/flask/testing.py","type":"import"},{"source":"src/flask/app.py","target":"src/flask/typing.py","type":"import"},{"source":"src/flask/app.py","target":"src/flask/wrappers.py","type":"import"},{"source":"src/flask/blueprints.py","target":"src/flask/cli.py","type":"import"},{"source":"src/flask/blueprints.py","target":"src/flask/globals.py","type":"import"},{"source":"src/flask/blueprints.py","target":"src/flask/helpers.py","type":"import"},{"source":"src/flask/blueprints.py","target":"src/flask/sansio/blueprints.py","type":"import"},{"source":"src/flask/blueprints.py","target":"src/flask/sansio/scaffold.py","type":"import"},{"source":"src/flask/blueprints.py","target":"src/flask/wrappers.py","type":"import"},{"source":"src/flask/cli.py","target":"src/flask/__init__.py","type":"import"},{"source":"src/flask/cli.py","target":"src/flask/app.py","type":"import"},{"source":"src/flask/cli.py","target":"src/flask/globals.py","type":"import"},{"source":"src/flask/cli.py","target":"src/flask/helpers.py","type":"import"},{"source":"src/flask/config.py","target":"src/flask/sansio/app.py","type":"import"},{"source":"src/flask/ctx.py","target":"src/flask/__init__.py","type":"import"},{"source":"src/flask/ctx.py","target":"src/flask/app.py","type":"import"},{"source":"src/flask/ctx.py","target":"src/flask/globals.py","type":"import"},{"source":"src/flask/ctx.py","target":"src/flask/helpers.py","type":"import"},{"source":"src/flask/ctx.py","target":"src/flask/sessions.py","type":"import"},{"source":"src/flask/ctx.py","target":"src/flask/signals.py","type":"import"},{"source":"src/flask/ctx.py","target":"src/flask/wrappers.py","type":"import"},{"source":"src/flask/debughelpers.py","target":"src/flask/blueprints.py","type":"import"},{"source":"src/flask/debughelpers.py","target":"src/flask/globals.py","type":"import"},{"source":"src/flask/debughelpers.py","target":"src/flask/sansio/app.py","type":"import"},{"source":"src/flask/debughelpers.py","target":"src/flask/sansio/scaffold.py","type":"import"},{"source":"src/flask/debughelpers.py","target":"src/flask/wrappers.py","type":"import"},{"source":"src/flask/globals.py","target":"src/flask/app.py","type":"import"},{"source":"src/flask/globals.py","target":"src/flask/ctx.py","type":"import"},{"source":"src/flask/globals.py","target":"src/flask/sessions.py","type":"import"},{"source":"src/flask/globals.py","target":"src/flask/wrappers.py","type":"import"},{"source":"src/flask/helpers.py","target":"src/flask/globals.py","type":"import"},{"source":"src/flask/helpers.py","target":"src/flask/signals.py","type":"import"},{"source":"src/flask/helpers.py","target":"src/flask/wrappers.py","type":"import"},{"source":"src/flask/json/__init__.py","target":"src/flask/globals.py","type":"import"},{"source":"src/flask/json/__init__.py","target":"src/flask/json/provider.py","type":"import"},{"source":"src/flask/json/__init__.py","target":"src/flask/wrappers.py","type":"import"},{"source":"src/flask/json/provider.py","target":"src/flask/sansio/app.py","type":"import"},{"source":"src/flask/json/tag.py","target":"src/flask/json/__init__.py","type":"import"},{"source":"src/flask/logging.py","target":"src/flask/globals.py","type":"import"},{"source":"src/flask/logging.py","target":"src/flask/sansio/app.py","type":"import"},{"source":"src/flask/sansio/app.py","target":"src/flask/__init__.py","type":"import"},{"source":"src/flask/sansio/app.py","target":"src/flask/config.py","type":"import"},{"source":"src/flask/sansio/app.py","target":"src/flask/ctx.py","type":"import"},{"source":"src/flask/sansio/app.py","target":"src/flask/helpers.py","type":"import"},{"source":"src/flask/sansio/app.py","target":"src/flask/json/provider.py","type":"import"},{"source":"src/flask/sansio/app.py","target":"src/flask/logging.py","type":"import"},{"source":"src/flask/sansio/app.py","target":"src/flask/sansio/blueprints.py","type":"import"},{"source":"src/flask/sansio/app.py","target":"src/flask/sansio/scaffold.py","type":"import"},{"source":"src/flask/sansio/app.py","target":"src/flask/templating.py","type":"import"},{"source":"src/flask/sansio/app.py","target":"src/flask/testing.py","type":"import"},{"source":"src/flask/sansio/blueprints.py","target":"src/flask/__init__.py","type":"import"},{"source":"src/flask/sansio/blueprints.py","target":"src/flask/sansio/app.py","type":"import"},{"source":"src/flask/sansio/blueprints.py","target":"src/flask/sansio/scaffold.py","type":"import"},{"source":"src/flask/sansio/scaffold.py","target":"src/flask/__init__.py","type":"import"},{"source":"src/flask/sansio/scaffold.py","target":"src/flask/helpers.py","type":"import"},{"source":"src/flask/sansio/scaffold.py","target":"src/flask/templating.py","type":"import"},{"source":"src/flask/sessions.py","target":"src/flask/app.py","type":"import"},{"source":"src/flask/sessions.py","target":"src/flask/json/tag.py","type":"import"},{"source":"src/flask/sessions.py","target":"src/flask/wrappers.py","type":"import"},{"source":"src/flask/templating.py","target":"src/flask/ctx.py","type":"import"},{"source":"src/flask/templating.py","target":"src/flask/debughelpers.py","type":"import"},{"source":"src/flask/templating.py","target":"src/flask/globals.py","type":"import"},{"source":"src/flask/templating.py","target":"src/flask/helpers.py","type":"import"},{"source":"src/flask/templating.py","target":"src/flask/sansio/app.py","type":"import"},{"source":"src/flask/templating.py","target":"src/flask/sansio/scaffold.py","type":"import"},{"source":"src/flask/templating.py","target":"src/flask/signals.py","type":"import"},{"source":"src/flask/testing.py","target":"src/flask/app.py","type":"import"},{"source":"src/flask/testing.py","target":"src/flask/cli.py","type":"import"},{"source":"src/flask/testing.py","target":"src/flask/sessions.py","type":"import"},{"source":"src/flask/views.py","target":"src/flask/__init__.py","type":"import"},{"source":"src/flask/views.py","target":"src/flask/globals.py","type":"import"},{"source":"src/flask/wrappers.py","target":"src/flask/__init__.py","type":"import"},{"source":"src/flask/wrappers.py","target":"src/flask/debughelpers.py","type":"import"},{"source":"src/flask/wrappers.py","target":"src/flask/globals.py","type":"import"},{"source":"src/flask/wrappers.py","target":"src/flask/helpers.py","type":"import"}]}/*__END__*/;
</script>

<script>
// ═══════════════════════════════════════════════════════════════════
//  XRAY DASHBOARD — Main Script
// ═══════════════════════════════════════════════════════════════════

(function () {
'use strict';

// ── Language Color Palette ──────────────────────────────────────────
const LANG_COLORS = {
  python:     '#3776ab',
  javascript: '#f7df1e',
  typescript: '#3178c6',
  css:        '#264de4',
  html:       '#e34c26',
  java:       '#b07219',
  cpp:        '#f34b7d',
  c:          '#555555',
  rust:       '#dea584',
  go:         '#00add8',
  ruby:       '#701516',
  php:        '#4f5d95',
  swift:      '#fa7343',
  kotlin:     '#a97bff',
  markdown:   '#083fa1',
  json:       '#40d158',
  yaml:       '#cb171e',
  shell:      '#89e051',
  dockerfile: '#0db7ed',
  sql:        '#e38c00',
  r:          '#198ce7',
  scala:      '#c22d40',
};

function langColor(lang) {
  return LANG_COLORS[(lang || '').toLowerCase()] || '#6e7681';
}

// ── Helpers ─────────────────────────────────────────────────────────
function fmtNum(n) {
  if (n == null) return '—';
  return n.toLocaleString();
}

function fmtSize(bytes) {
  if (bytes == null) return '—';
  if (bytes < 1024) return bytes + ' B';
  if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
  return (bytes / 1024 / 1024).toFixed(2) + ' MB';
}

function fmtDate(s) {
  if (!s) return '—';
  try { return new Date(s).toLocaleDateString(); } catch(e) { return s; }
}

function basename(path) {
  return (path || '').split('/').pop();
}

function clamp(v, lo, hi) {
  return Math.max(lo, Math.min(hi, v));
}

// ── Tooltip ─────────────────────────────────────────────────────────
const TT = (() => {
  const el = document.getElementById('tooltip');
  let _timer;

  function show(html, event) {
    clearTimeout(_timer);
    el.innerHTML = html;
    el.classList.add('visible');
    move(event);
  }

  function move(event) {
    if (!event) return;
    const pad = 14;
    const tw = el.offsetWidth, th = el.offsetHeight;
    const vw = window.innerWidth, vh = window.innerHeight;
    let x = event.clientX + pad;
    let y = event.clientY + pad;
    if (x + tw > vw - pad) x = event.clientX - tw - pad;
    if (y + th > vh - pad) y = event.clientY - th - pad;
    el.style.left = x + 'px';
    el.style.top  = y + 'px';
  }

  function hide() {
    _timer = setTimeout(() => el.classList.remove('visible'), 80);
  }

  return { show, move, hide };
})();

// ── Data Processing ──────────────────────────────────────────────────
const D = XRAY_DATA;
const nodes = D.nodes || [];
const edges = D.edges || [];
const meta  = D.meta  || {};
const summary = D.summary || {};

// Build dep counts
const depCount = {};
nodes.forEach(n => depCount[n.id] = 0);
edges.forEach(e => { if (depCount[e.source] != null) depCount[e.source]++; });

// Augment nodes
nodes.forEach(n => {
  n._deps = depCount[n.id] || 0;
  n._name = basename(n.id);
});

// ── Stats Bar ────────────────────────────────────────────────────────
document.getElementById('s-files').textContent =
  fmtNum(summary.total_files || nodes.length);
document.getElementById('s-lines').textContent =
  fmtNum(summary.total_lines || nodes.reduce((s, n) => s + (n.lines || 0), 0));
document.getElementById('s-langs').textContent =
  fmtNum(summary.languages ? Object.keys(summary.languages).length : 0);
document.getElementById('s-time').textContent =
  meta.scan_time ? fmtDate(meta.scan_time) : '—';

// ── Global Filter ────────────────────────────────────────────────────
let globalFilter = '';
document.getElementById('global-filter').addEventListener('input', function () {
  globalFilter = this.value.toLowerCase().trim();
  if (currentTab === 'treemap') buildTreemap();
  else if (currentTab === 'force') buildForce();
  else if (currentTab === 'heatmap') buildHeatmap();
  else if (currentTab === 'table') renderTable();
});

// ── Tab Routing ──────────────────────────────────────────────────────
let currentTab = 'treemap';
const tabBuilt  = {};

document.querySelectorAll('.tab').forEach(tab => {
  tab.addEventListener('click', function () {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    this.classList.add('active');
    const id = this.dataset.tab;
    currentTab = id;
    document.getElementById('view-' + id).classList.add('active');
    buildView(id);
  });
});

function buildView(id) {
  if (id === 'treemap')  { buildTreemap(); }
  else if (id === 'force')   { if (!tabBuilt.force)   { buildForce(); tabBuilt.force = true; } }
  else if (id === 'heatmap') { buildHeatmap(); }
  else if (id === 'table')   { if (!tabBuilt.table) { initTable(); tabBuilt.table = true; } else { renderTable(); } }
}

// initial build
buildTreemap();

// ═══════════════════════════════════════════════════════════════════
//  VIEW 1 — TREEMAP
// ═══════════════════════════════════════════════════════════════════
let treemapZoomPath = [];

function filteredNodes() {
  if (!globalFilter) return nodes;
  return nodes.filter(n =>
    n.id.toLowerCase().includes(globalFilter) ||
    (n.language || '').toLowerCase().includes(globalFilter)
  );
}

function buildTreemap() {
  const wrap = document.getElementById('treemap-svg-wrap');
  wrap.innerHTML = '';

  const filtered = filteredNodes();
  if (!filtered.length) {
    wrap.innerHTML = '<div class="empty-state"><div class="empty-icon">&#128269;</div><div>No files match filter</div></div>';
    return;
  }

  const W = wrap.clientWidth  || 900;
  const H = wrap.clientHeight || 600;

  // Build hierarchy
  const root = buildHierarchy(filtered);
  const hier = d3.hierarchy(root)
    .sum(d => d.lines || 0)
    .sort((a, b) => b.value - a.value);

  d3.treemap()
    .size([W, H])
    .paddingOuter(4)
    .paddingTop(22)
    .paddingInner(2)
    .round(true)(hier);

  const svg = d3.select(wrap).append('svg')
    .attr('width', W)
    .attr('height', H);

  // Clip path
  svg.append('defs').append('clipPath')
    .attr('id', 'treemap-clip')
    .append('rect')
    .attr('width', W)
    .attr('height', H);

  const g = svg.append('g').attr('clip-path', 'url(#treemap-clip)');

  function renderLevel(node) {
    g.selectAll('*').remove();
    const leaves = node.leaves();
    const dirs   = node.children ? node.children.filter(c => c.children) : [];

    // Directory label backgrounds
    dirs.forEach(dir => {
      g.append('rect')
        .attr('x', dir.x0)
        .attr('y', dir.y0)
        .attr('width', dir.x1 - dir.x0)
        .attr('height', dir.y1 - dir.y0)
        .attr('fill', 'rgba(255,255,255,0.03)')
        .attr('stroke', '#30363d')
        .attr('stroke-width', 1)
        .attr('rx', 3)
        .style('cursor', 'pointer')
        .on('click', (event) => {
          treemapZoomPath.push(dir);
          renderLevel(dir);
          updateBreadcrumb();
        });

      if (dir.x1 - dir.x0 > 30) {
        g.append('text')
          .attr('x', dir.x0 + 6)
          .attr('y', dir.y0 + 14)
          .attr('font-size', 11)
          .attr('font-weight', 700)
          .attr('fill', '#8b949e')
          .text(dir.data.name);
      }
    });

    // File cells
    const cells = g.selectAll('.treemap-cell')
      .data(leaves)
      .join('g')
      .attr('class', 'treemap-cell')
      .attr('transform', d => `translate(${d.x0},${d.y0})`);

    cells.append('rect')
      .attr('width', d => Math.max(0, d.x1 - d.x0))
      .attr('height', d => Math.max(0, d.y1 - d.y0))
      .attr('fill', d => langColor(d.data.language))
      .attr('rx', 2)
      .style('cursor', 'default');

    cells.filter(d => d.x1 - d.x0 > 40 && d.y1 - d.y0 > 18)
      .append('text')
      .attr('x', 5)
      .attr('y', 14)
      .text(d => {
        const maxChars = Math.floor((d.x1 - d.x0 - 10) / 6.5);
        const name = d.data._name || d.data.id;
        return name.length > maxChars ? name.slice(0, maxChars - 1) + '…' : name;
      });

    cells.filter(d => d.x1 - d.x0 > 60 && d.y1 - d.y0 > 32)
      .append('text')
      .attr('x', 5)
      .attr('y', 28)
      .attr('fill', 'rgba(255,255,255,0.55)')
      .attr('font-size', 9)
      .text(d => fmtNum(d.data.lines) + ' ln');

    cells
      .on('mousemove', (event, d) => {
        TT.show(`
          <div class="tt-title">${d.data.id}</div>
          <div class="tt-row"><span class="tt-label">Language</span><span class="tt-val">${d.data.language || '—'}</span></div>
          <div class="tt-row"><span class="tt-label">Lines</span><span class="tt-val">${fmtNum(d.data.lines)}</span></div>
          <div class="tt-row"><span class="tt-label">Size</span><span class="tt-val">${fmtSize(d.data.size)}</span></div>
          <div class="tt-row"><span class="tt-label">Commits</span><span class="tt-val">${fmtNum(d.data.git_commits)}</span></div>
        `, event);
      })
      .on('mouseleave', TT.hide);
  }

  // Build breadcrumb
  function updateBreadcrumb() {
    const bc = document.getElementById('treemap-breadcrumb');
    bc.innerHTML = '';
    const parts = [{ name: meta.project || 'root', node: hier }].concat(
      treemapZoomPath.map(n => ({ name: n.data.name, node: n }))
    );
    parts.forEach((p, i) => {
      const span = document.createElement('span');
      span.className = 'bc-item';
      span.textContent = p.name;
      span.addEventListener('click', () => {
        treemapZoomPath = treemapZoomPath.slice(0, i);
        renderLevel(i === 0 ? hier : treemapZoomPath[i - 1]);
        updateBreadcrumb();
      });
      bc.appendChild(span);
      if (i < parts.length - 1) {
        const sep = document.createElement('span');
        sep.className = 'bc-sep';
        sep.textContent = ' / ';
        bc.appendChild(sep);
      }
    });
  }

  const targetNode = treemapZoomPath.length
    ? treemapZoomPath[treemapZoomPath.length - 1]
    : hier;
  renderLevel(targetNode);
  updateBreadcrumb();
}

function buildHierarchy(nodeList) {
  const root = { name: meta.project || 'root', children: [] };
  const dirs = {};

  nodeList.forEach(n => {
    const dir = n.directory || '';
    if (!dirs[dir]) {
      dirs[dir] = { name: dir || '(root)', children: [] };
      root.children.push(dirs[dir]);
    }
    dirs[dir].children.push(n);
  });

  return root;
}

// ═══════════════════════════════════════════════════════════════════
//  VIEW 2 — FORCE GRAPH
// ═══════════════════════════════════════════════════════════════════
function buildForce() {
  const wrap = document.getElementById('force-svg-wrap');
  wrap.innerHTML = '';

  const filtered = filteredNodes();
  const filteredIds = new Set(filtered.map(n => n.id));
  const filteredEdges = edges.filter(e =>
    filteredIds.has(e.source) && filteredIds.has(e.target)
  );

  if (!filtered.length) {
    wrap.innerHTML = '<div class="empty-state"><div class="empty-icon">&#9672;</div><div>No files match filter</div></div>';
    return;
  }

  const W = wrap.clientWidth  || 900;
  const H = wrap.clientHeight || 600;

  const maxLines = d3.max(filtered, d => d.lines) || 1;

  const r = d => clamp(Math.sqrt((d.lines || 1) / maxLines) * 22, 4, 22);

  // SVG
  const svg = d3.select(wrap).append('svg')
    .attr('width', W)
    .attr('height', H)
    .call(d3.zoom()
      .scaleExtent([0.15, 4])
      .on('zoom', (event) => g.attr('transform', event.transform))
    );

  // Arrow marker
  const defs = svg.append('defs');
  defs.append('marker')
    .attr('id', 'arrowhead')
    .attr('viewBox', '-0 -5 10 10')
    .attr('refX', 18)
    .attr('refY', 0)
    .attr('orient', 'auto')
    .attr('markerWidth', 6)
    .attr('markerHeight', 6)
    .append('path')
    .attr('d', 'M 0,-5 L 10,0 L 0,5')
    .attr('fill', '#484f58');

  const g = svg.append('g');

  // Simulation
  const linkData = filteredEdges.map(e => ({
    source: e.source,
    target: e.target,
    type: e.type
  }));

  const sim = d3.forceSimulation(filtered)
    .force('link', d3.forceLink(linkData).id(d => d.id).distance(90).strength(0.3))
    .force('charge', d3.forceManyBody().strength(-200))
    .force('center', d3.forceCenter(W / 2, H / 2))
    .force('collision', d3.forceCollide().radius(d => r(d) + 4));

  // Links
  const link = g.selectAll('.force-link')
    .data(linkData)
    .join('line')
    .attr('class', 'force-link');

  // Nodes
  const nodeG = g.selectAll('.force-node')
    .data(filtered)
    .join('g')
    .attr('class', 'force-node')
    .call(d3.drag()
      .on('start', (event, d) => {
        if (!event.active) sim.alphaTarget(0.3).restart();
        d.fx = d.x; d.fy = d.y;
      })
      .on('drag', (event, d) => { d.fx = event.x; d.fy = event.y; })
      .on('end', (event, d) => {
        if (!event.active) sim.alphaTarget(0);
        d.fx = null; d.fy = null;
      })
    );

  nodeG.append('circle')
    .attr('r', d => r(d))
    .attr('fill', d => langColor(d.language))
    .attr('stroke', '#0d1117')
    .attr('stroke-width', 1.5);

  nodeG.append('text')
    .attr('dy', d => r(d) + 11)
    .attr('text-anchor', 'middle')
    .text(d => d._name);

  // Hover interactions
  const adjSet = buildAdjSet(linkData);

  nodeG
    .on('mousemove', (event, d) => {
      const inDeps  = edges.filter(e => e.target === d.id).length;
      const outDeps = edges.filter(e => e.source === d.id).length;
      TT.show(`
        <div class="tt-title">${d.id}</div>
        <div class="tt-row"><span class="tt-label">Language</span><span class="tt-val">${d.language || '—'}</span></div>
        <div class="tt-row"><span class="tt-label">Lines</span><span class="tt-val">${fmtNum(d.lines)}</span></div>
        <div class="tt-row"><span class="tt-label">Imports</span><span class="tt-val">${outDeps}</span></div>
        <div class="tt-row"><span class="tt-label">Imported by</span><span class="tt-val">${inDeps}</span></div>
      `, event);

      const connected = adjSet[d.id] || new Set();
      nodeG.classed('dimmed', n => n.id !== d.id && !connected.has(n.id));
      nodeG.classed('highlighted', n => n.id === d.id);
      link.classed('dimmed', l =>
        l.source.id !== d.id && l.target.id !== d.id
      );
      link.classed('highlighted', l =>
        l.source.id === d.id || l.target.id === d.id
      );
    })
    .on('mouseleave', () => {
      TT.hide();
      nodeG.classed('dimmed', false).classed('highlighted', false);
      link.classed('dimmed', false).classed('highlighted', false);
    });

  sim.on('tick', () => {
    link
      .attr('x1', d => d.source.x)
      .attr('y1', d => d.source.y)
      .attr('x2', d => d.target.x)
      .attr('y2', d => d.target.y);

    nodeG.attr('transform', d => `translate(${d.x},${d.y})`);
  });

  // Legend
  const langs = [...new Set(filtered.map(n => n.language).filter(Boolean))].sort();
  const legWrap = document.getElementById('force-legend-items');
  legWrap.innerHTML = '';
  langs.forEach(lang => {
    const item = document.createElement('div');
    item.className = 'leg-item';
    item.innerHTML = `<div class="leg-dot" style="background:${langColor(lang)}"></div><span>${lang}</span>`;
    legWrap.appendChild(item);
  });
}

function buildAdjSet(links) {
  const adj = {};
  links.forEach(l => {
    const s = typeof l.source === 'object' ? l.source.id : l.source;
    const t = typeof l.target === 'object' ? l.target.id : l.target;
    if (!adj[s]) adj[s] = new Set();
    if (!adj[t]) adj[t] = new Set();
    adj[s].add(t);
    adj[t].add(s);
  });
  return adj;
}

// ═══════════════════════════════════════════════════════════════════
//  VIEW 3 — HEATMAP
// ═══════════════════════════════════════════════════════════════════
function buildHeatmap() {
  const container = document.getElementById('heatmap-container');
  container.innerHTML = '';

  const filtered = filteredNodes();
  if (!filtered.length) {
    container.innerHTML = '<div class="empty-state"><div class="empty-icon">&#9635;</div><div>No files match filter</div></div>';
    return;
  }

  // Use git_commits if available, else lines
  const useCommits = filtered.some(n => n.git_commits != null && n.git_commits > 0);
  const getValue = n => useCommits ? (n.git_commits || 0) : (n.lines || 0);
  const maxVal = d3.max(filtered, getValue) || 1;

  // Gradient legend
  const canvas = document.getElementById('heatmap-gradient');
  const ctx = canvas.getContext('2d');
  const grad = ctx.createLinearGradient(0, 0, 160, 0);
  grad.addColorStop(0,   '#0d1117');
  grad.addColorStop(0.3, '#0e4429');
  grad.addColorStop(0.6, '#006d32');
  grad.addColorStop(0.8, '#26a641');
  grad.addColorStop(1,   '#39d353');
  ctx.fillStyle = grad;
  ctx.fillRect(0, 0, 160, 12);

  document.getElementById('heatmap-legend-label').textContent =
    useCommits ? 'Git commits:' : 'Lines of code:';

  // Color scale (GitHub contribution style)
  const colorScale = d3.scaleSequential()
    .domain([0, maxVal])
    .interpolator(t => {
      if (t < 0.001) return '#161b22';
      if (t < 0.2)   return '#0e4429';
      if (t < 0.4)   return '#006d32';
      if (t < 0.7)   return '#26a641';
      return '#39d353';
    });

  // Group by directory
  const groups = {};
  filtered.forEach(n => {
    const dir = n.directory || '(root)';
    if (!groups[dir]) groups[dir] = [];
    groups[dir].push(n);
  });

  Object.keys(groups).sort().forEach(dir => {
    const grp = document.createElement('div');
    grp.className = 'hm-dir-group';

    const label = document.createElement('div');
    label.className = 'hm-dir-label';
    label.textContent = dir;
    grp.appendChild(label);

    const cells = document.createElement('div');
    cells.className = 'hm-cells';

    groups[dir].forEach(n => {
      const cell = document.createElement('div');
      cell.className = 'hm-cell';
      const v = getValue(n);
      cell.style.background = colorScale(v);
      cell.title = n._name;

      cell.addEventListener('mousemove', (e) => {
        TT.show(`
          <div class="tt-title">${n.id}</div>
          <div class="tt-row"><span class="tt-label">${useCommits ? 'Commits' : 'Lines'}</span><span class="tt-val">${fmtNum(v)}</span></div>
          <div class="tt-row"><span class="tt-label">Language</span><span class="tt-val">${n.language || '—'}</span></div>
          <div class="tt-row"><span class="tt-label">Last modified</span><span class="tt-val">${fmtDate(n.git_last_modified)}</span></div>
        `, e);
      });
      cell.addEventListener('mouseleave', TT.hide);
      cells.appendChild(cell);
    });

    grp.appendChild(cells);
    container.appendChild(grp);
  });
}

// ═══════════════════════════════════════════════════════════════════
//  VIEW 4 — TABLE
// ═══════════════════════════════════════════════════════════════════
let tableSort  = { col: 'lines', dir: 'desc' };
let tableQuery = '';
let showAll    = false;
const PAGE_SIZE = 200;

function initTable() {
  // Table search syncs with global filter
  const ts = document.getElementById('table-search');
  ts.value = globalFilter;
  tableQuery = globalFilter;

  ts.addEventListener('input', function () {
    tableQuery = this.value.toLowerCase().trim();
    showAll = false;
    renderTable();
  });

  document.querySelectorAll('#data-table th').forEach(th => {
    th.addEventListener('click', function () {
      const col = this.dataset.col;
      if (tableSort.col === col) {
        tableSort.dir = tableSort.dir === 'asc' ? 'desc' : 'asc';
      } else {
        tableSort = { col, dir: col === 'id' || col === 'language' || col === 'category' ? 'asc' : 'desc' };
      }
      renderTable();
    });
  });

  document.getElementById('table-show-all').addEventListener('click', () => {
    showAll = true;
    renderTable();
  });

  renderTable();
}

function renderTable() {
  // Sync table search with global filter if table search is empty
  const ts = document.getElementById('table-search');
  const query = tableQuery || globalFilter;
  if (ts && !tableQuery && globalFilter) ts.value = globalFilter;

  let data = nodes.slice();

  if (query) {
    data = data.filter(n =>
      n.id.toLowerCase().includes(query) ||
      (n.language || '').toLowerCase().includes(query) ||
      (n.category || '').toLowerCase().includes(query)
    );
  }

  // Sort
  const col = tableSort.col;
  data.sort((a, b) => {
    let va, vb;
    if (col === 'id')       { va = a.id; vb = b.id; }
    else if (col === 'language')  { va = a.language || ''; vb = b.language || ''; }
    else if (col === 'category')  { va = a.category || ''; vb = b.category || ''; }
    else if (col === 'lines')     { va = a.lines || 0; vb = b.lines || 0; }
    else if (col === 'size')      { va = a.size  || 0; vb = b.size  || 0; }
    else if (col === 'deps')      { va = a._deps || 0; vb = b._deps || 0; }
    else if (col === 'git_commits') { va = a.git_commits || 0; vb = b.git_commits || 0; }
    else { va = ''; vb = ''; }

    if (typeof va === 'string') {
      return tableSort.dir === 'asc'
        ? va.localeCompare(vb)
        : vb.localeCompare(va);
    }
    return tableSort.dir === 'asc' ? va - vb : vb - va;
  });

  // Update sort indicators
  document.querySelectorAll('#data-table th').forEach(th => {
    th.classList.remove('sort-asc', 'sort-desc');
    if (th.dataset.col === tableSort.col) {
      th.classList.add(tableSort.dir === 'asc' ? 'sort-asc' : 'sort-desc');
    }
  });

  const total = data.length;
  const displayed = showAll ? data : data.slice(0, PAGE_SIZE);
  const hasMore = !showAll && total > PAGE_SIZE;

  document.getElementById('table-row-count').textContent =
    `${fmtNum(displayed.length)} of ${fmtNum(total)} files`;

  const showAllBtn = document.getElementById('table-show-all');
  if (hasMore) {
    showAllBtn.classList.remove('hidden');
    showAllBtn.textContent = `Show all ${fmtNum(total)}`;
  } else {
    showAllBtn.classList.add('hidden');
  }

  const tbody = document.getElementById('table-body');
  tbody.innerHTML = '';

  displayed.forEach(n => {
    const tr = document.createElement('tr');
    const color = langColor(n.language);

    tr.innerHTML = `
      <td title="${n.id}">${n._name}</td>
      <td><span class="lang-badge" style="background:${color}22;color:${color};border:1px solid ${color}44">${n.language || '—'}</span></td>
      <td>${n.category || '—'}</td>
      <td class="num-cell">${fmtNum(n.lines)}</td>
      <td class="num-cell">${fmtSize(n.size)}</td>
      <td class="num-cell">${fmtNum(n._deps)}</td>
      <td class="num-cell">${n.git_commits != null ? fmtNum(n.git_commits) : '—'}</td>
    `;
    tbody.appendChild(tr);
  });
}

// ═══════════════════════════════════════════════════════════════════
//  RESIZE HANDLER
// ═══════════════════════════════════════════════════════════════════
let resizeTimer;
window.addEventListener('resize', () => {
  clearTimeout(resizeTimer);
  resizeTimer = setTimeout(() => {
    if (currentTab === 'treemap') buildTreemap();
    else if (currentTab === 'force') {
      tabBuilt.force = false;
      buildForce();
      tabBuilt.force = true;
    }
  }, 250);
});

})(); // end IIFE
</script>
</body>
</html>
